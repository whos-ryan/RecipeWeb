@page "/"
@inject RecipeService Service
@inject NavigationManager Nav

@{
	var list = Service.GetAll();
	var total = list.Count;
	var unique = list.SelectMany(x => x.Ingredients).Where(x => !string.IsNullOrWhiteSpace(x)).Select(x => x.Trim()).Distinct(StringComparer.OrdinalIgnoreCase).Count();
	var month = DateTime.Now.ToString("MMMM yyyy");
	var last = list.LastOrDefault();
}

<section class="hero">
	<h1>recipe manager</h1>
	<p>all your meals in one place</p>
	<div class="heroactions">
		<button class="button primary" @onclick='() => Nav.NavigateTo("/add")'>add recipe</button>
		<button class="button" @onclick='() => Nav.NavigateTo("/search")'>browse</button>
	</div>
</section>

<section class="homegrid">
	<article class="card stat">
		<p class="key">recipes</p>
		<p class="num">@total</p>
	</article>
	<article class="card stat">
		<p class="key">ingredients</p>
		<p class="num">@unique</p>
	</article>
	<article class="card stat">
		<p class="key">month</p>
		<p class="num">@month</p>
	</article>
</section>

<section class="latest">
	<div class="head">
		<h2>latest</h2>
	</div>
	@if (last is not null)
	{
		<button class="card pick" @onclick='() => Nav.NavigateTo("/search")'>
			<p class="title">@last.Name</p>
			<p class="meta">@string.Join(", ", last.Ingredients.Take(5))</p>
		</button>
	}
	else
	{
		<div class="card empty">
			<p>empty</p>
			<button class="button primary" @onclick='() => Nav.NavigateTo("/add")'>add</button>
		</div>
	}
</section>
