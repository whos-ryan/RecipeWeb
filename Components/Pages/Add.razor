@page "/add"
@inject RecipeService Service
@inject NavigationManager Nav

<h1 class="title">Add</h1>

<section class="card form">
	<label class="field">
		<span>Name</span>
		<input @bind="name" />
	</label>
	<label class="field">
		<span>Ingredients</span>
		<input @bind="items" />
	</label>
	<label class="field">
		<span>Steps</span>
		<textarea @bind="steps" rows="5"></textarea>
	</label>
	@if (warn)
	{
		<p class="warn">Required</p>
	}
	<div class="actions">
		<button class="button" @onclick='() => Nav.NavigateTo("/")'>Cancel</button>
		<button class="button primary" @onclick="Save">Save</button>
	</div>
</section>

@code {
	private string name = "";
	private string items = "";
	private string steps = "";
	private bool warn;

	private void Save()
	{
		if (string.IsNullOrWhiteSpace(name))
		{
			warn = true;
			return;
		}

		var list = items.Split(',').Select(x => x.Trim()).Where(x => x.Length > 0).ToList();
		Service.Add(new Recipe(name.Trim(), list, steps.Trim()));
		Nav.NavigateTo("/");
	}
}
